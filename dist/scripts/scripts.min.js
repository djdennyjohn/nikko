"use strict";var app=angular.module("app",["ui.router","infinite-scroll","angular.filter","angular-click-outside"]);app.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/home"),e.state("app",{url:"/home",templateUrl:"./views/home.html"})}]),app.directive("backgroundImageDirective",[function(){return function(e,t,a){"posterthatismissing.jpg"===a.backgroundImageDirective?t.attr({src:"./Slices/placeholder_for_missing_posters.png",class:"missing-poster"}):t.attr({src:"./Slices/"+a.backgroundImageDirective})}}]),app.filter("cut",[function(){return function(e,t,a,r){if(!e)return"";if(!(a=parseInt(a,10)))return e;if(e.length<=a)return e;if(e=e.substr(0,a),t){var n=e.lastIndexOf(" ");-1!=n&&(e=e.substr(0,n))}return e+(r||" â€¦")}}]),app.factory("dataService",["$http",function(e){return{get:function(t){return e.get("./API/CONTENTLISTINGPAGE-PAGE"+t+".json",{}).then(function(e){return e})}}}]),app.controller("MainCtrl",["dataService",function(e){var t=this;t.page=1,t.shots=[],t.loadingMore=!1,t.loadMoreShots=function(){if(!(t.loadingMore||t.page>t.totalPages)){t.loadingMore=!0;var a=e.get(t.page);return a.then(function(e){var a=angular.copy(t.shots);a=a.concat(e.data.page["content-items"].content),t.shots=a,t.loadingMore=!1,t.page++},function(){t.loadingMore=!1}),a}},t.initializePagingData=function(){e.get(t.page).then(function(e){t.totalPages=Math.ceil(e.data.page["total-content-items"]/e.data.page["page-size-requested"]),t.loadMoreShots()})},t.initializePagingData()}]),app.controller("SearchCtrl",["dataService",function(e){var t=this;t.searchIndex=[],t.searchResult=[],t.searchMovies=function(){if(t.searchResult=[],0===t.searchText.length)return t.searchResult;for(var e=0;e<t.searchIndex.length;e++)-1!==t.searchIndex[e].name.toLowerCase().indexOf(t.searchText.toLowerCase())&&t.searchResult.push(t.searchIndex[e])},t.buildSearchIndex=function(){for(var a=1;a<=3;a++){e.get(a).then(function(e){var a=angular.copy(t.searchIndex);a=a.concat(e.data.page["content-items"].content),t.searchIndex=a})}},t.buildSearchIndex(),t.closeThis=function(){t.searchResult=[],t.searchText=""}}]);